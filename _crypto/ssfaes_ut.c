/* --------------------------------------------------------------------------------------------- */
/* Small System Framework                                                                        */
/*                                                                                               */
/* ssfaes_ut.c                                                                                   */
/* Provides AES interface unit test.                                                             */
/*                                                                                               */
/* BSD-3-Clause License                                                                          */
/* Copyright 2021 Supurloop Software LLC                                                         */
/*                                                                                               */
/* Redistribution and use in source and binary forms, with or without modification, are          */
/* permitted provided that the following conditions are met:                                     */
/*                                                                                               */
/* 1. Redistributions of source code must retain the above copyright notice, this list of        */
/* conditions and the following disclaimer.                                                      */
/* 2. Redistributions in binary form must reproduce the above copyright notice, this list of     */
/* conditions and the following disclaimer in the documentation and/or other materials provided  */
/* with the distribution.                                                                        */
/* 3. Neither the name of the copyright holder nor the names of its contributors may be used to  */
/* endorse or promote products derived from this software without specific prior written         */
/* permission.                                                                                   */
/*                                                                                               */
/* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS   */
/* OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF               */
/* MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE    */
/* COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL      */
/* EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE */
/* GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUinION) HOWEVER CAUSED    */
/* AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING     */
/* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISE   */
/* OF THE POSSIBILITY OF SUCH DAMAGE.                                                            */
/* --------------------------------------------------------------------------------------------- */
#include <stdint.h>
#include <stdbool.h>
#include <stdio.h>
#include "ssfaes.h"
#include "ssfassert.h"

#if SSF_CONFIG_AES_UNIT_TEST == 1

typedef struct SSFAESUT
{
    uint8_t *in;
    uint8_t *key;
    uint8_t *out;
} SSFAESUT_t;

SSFAESUT_t _SSFAES128BlockEncryptMonteUT[] = 
{
    {
        (uint8_t *)"\xb9\x14\x5a\x76\x8b\x7d\xc4\x89\xa0\x96\xb5\x46\xf4\x3b\x23\x1f",
        (uint8_t *)"\x13\x9a\x35\x42\x2f\x1d\x61\xde\x3c\x91\x78\x7f\xe0\x50\x7a\xfd",
        (uint8_t *)"\xd7\xc3\xff\xac\x90\x31\x23\x86\x50\x90\x1e\x15\x73\x64\xc3\x86"
    },
    {
        (uint8_t *)"\xb1\x33\x10\x58\x1f\xfe\x5b\x10\xaa\xef\xde\xb8\x99\x2a\xec\x18",
        (uint8_t *)"\x6b\xd6\x09\x71\x34\x68\x58\xe3\x1c\x3f\x37\x25\x4f\x18\xd3\x39",
        (uint8_t *)"\xb0\xea\xed\xe3\xf3\xee\xbf\xef\x88\x82\x2a\x6e\xde\x19\x50\xb1"
    },
    {
        (uint8_t *)"\x36\x09\x5d\xc3\xe6\x59\xec\x50\xca\x7f\x6f\x82\x07\xd2\x00\x31",
        (uint8_t *)"\xc2\xf2\x89\x9e\x42\xee\x16\xad\xf0\x0a\x65\x84\x25\x3a\xd0\x31",
        (uint8_t *)"\x8d\xbf\xe9\x65\x07\x84\x68\x87\x5d\x86\x14\x51\x64\xc4\xab\x4f"
    },
    {
        (uint8_t *)"\x8f\xc8\xef\x9a\xb7\x46\x27\x12\x97\x7e\x87\xc7\x41\x79\x5e\xce",
        (uint8_t *)"\x35\xd4\x08\xd6\x16\x91\x39\x28\x97\x03\x56\x13\xd6\xd6\x04\x58",
        (uint8_t *)"\x37\xe9\xac\x80\x0c\xfb\x19\x13\x3b\x4e\x9b\x0c\x41\x8c\xa0\x98"
    },
    {
        (uint8_t *)"\x87\x9d\xb7\x97\xe6\x86\xb9\x11\x6c\x25\xc0\x7f\x4a\xe6\x75\x93",
        (uint8_t *)"\xc4\xf5\xf7\xca\x90\x2b\xa7\x1a\x7c\x25\xd8\xe0\x86\xf8\xe7\x1d",
        (uint8_t *)"\x59\x59\xeb\xd7\xa1\x16\x77\x13\x42\x9e\xda\x69\x53\x8c\x53\x6b"
    },
    {
        (uint8_t *)"\x1c\xa0\x4a\x21\xad\xdc\x38\xef\x8b\xfc\x89\x89\xd3\xd6\xb3\x3b",
        (uint8_t *)"\xf6\x12\x78\xa8\x9a\xbd\xa9\xd7\x3c\x5e\xf0\x0e\x8f\xd3\xfb\xf4",
        (uint8_t *)"\xbb\x88\x75\xee\x3c\x3c\x8c\x09\x87\xb1\xc2\x0f\x99\x90\x28\xe9"
    },
    {
        (uint8_t *)"\x3a\xbd\x18\x67\x12\xa9\xde\xf7\x3b\x63\x12\xb5\x30\x0f\x02\xaf",
        (uint8_t *)"\x31\x5e\xde\xfb\x39\x50\x16\xd0\xe7\xbd\xed\x7b\x96\x97\x09\x7f",
        (uint8_t *)"\xb1\xe9\x0c\x8c\x0d\x4c\x96\x51\xa6\xde\x7f\x52\xa6\x3a\xc4\x56"
    },
    {
        (uint8_t *)"\x4e\x7c\xdd\x55\x3d\x73\x29\x09\xe2\x5a\x13\xa5\x21\xe0\x40\x78",
        (uint8_t *)"\xf3\xb3\xc8\x8d\x38\x95\x2f\x72\xb1\xe1\x5f\xac\xf6\x60\x29\x06",
        (uint8_t *)"\x9c\x16\xf3\xfd\xa4\x9b\xb6\xa2\xb6\xd7\x6a\x66\x96\xbd\x76\x8f"
    },
    {
        (uint8_t *)"\x04\xfc\xb0\xc7\x7a\xe0\xc9\x8d\x2a\xfb\x17\x8a\xb2\xc2\xb0\x2d",
        (uint8_t *)"\x96\xc8\x44\x83\x2f\x0b\x60\x45\x1f\x2c\x61\xa6\x4b\x06\xc5\xe3",
        (uint8_t *)"\x1a\x15\x65\x81\xb3\x55\x70\x78\x97\x1c\xc6\x87\x7a\x3d\x93\x39"
    },
    {
        (uint8_t *)"\xc3\x8c\x0b\xbd\xe0\x31\xd1\xa7\x94\x38\xf7\x9f\xf7\xcc\x68\xa5",
        (uint8_t *)"\xa4\xfe\x96\xb5\x04\x24\xcf\xf8\xda\x23\xbb\xfd\xa7\x9e\xa7\xf2",
        (uint8_t *)"\x86\x11\x31\x33\x96\x8a\xa3\x05\x27\x09\x87\x5b\xf0\x33\xd8\x04"
    },
    {
        (uint8_t *)"\x63\x47\x0b\xff\x05\x2e\x7f\x5c\x7a\x73\x5c\xc2\xe6\xeb\x61\xac",
        (uint8_t *)"\x22\x65\x4a\x9a\x06\x7a\xa0\x9b\x4e\x96\x5d\x0a\x2b\x82\x26\x4c",
        (uint8_t *)"\xf4\xfa\x6a\x35\x49\xcd\x2b\x33\xaf\x9c\xac\x13\x4d\x7b\x14\x02"
    },
    {
        (uint8_t *)"\x9c\xc9\x94\xed\xa6\x97\xfb\x55\x45\xea\xa5\x02\xb2\xa3\x0f\xd3",
        (uint8_t *)"\x94\xd5\xa2\x7f\x23\x0f\x07\x11\x21\xbe\x34\x6b\xfd\x73\xd7\xd0",
        (uint8_t *)"\xfb\x26\x49\x69\x47\x83\xb5\x51\xea\xcd\x9d\x5d\xb6\x12\x6d\x47"
    }
};

SSFAESUT_t _SSFAES192BlockEncryptMonteUT[] = 
{
    {
        (uint8_t *)"\x85\xa1\xf7\xa5\x81\x67\xb3\x89\xcd\xdc\x8a\x9f\xf1\x75\xee\x26",
        (uint8_t *)"\xb9\xa6\x3e\x09\xe1\xdf\xc4\x2e\x93\xa9\x0d\x9b\xad\x73\x9e\x59\x67\xae\xf6\x72\xee\xdd\x5d\xa9",
        (uint8_t *)"\xee\x83\xd8\x52\x79\xe0\x22\xd2\x04\x80\x31\xab\xee\xfb\xc4\xa4"
    },
    {
        (uint8_t *)"\x98\x65\x70\x51\xb2\x3c\x69\x74\x1b\x2a\xb5\x06\xf8\x18\xfd\x3f",
        (uint8_t *)"\x00\xfe\xb8\xbf\xfd\x6b\x4b\xcb\xc8\x90\x60\xc7\x49\x79\x6b\x16\xf6\xf5\x86\x10\x62\x15\x2f\x4f",
        (uint8_t *)"\xc9\xb6\xe9\x5f\xb5\x4b\x54\x0a\xdc\x1f\xaa\x8c\xec\xe0\x02\x86"
    },
    {
        (uint8_t *)"\x86\x81\x94\xc4\x4a\x68\xd8\xb4\x8e\x0e\xd4\xdb\xac\xde\xd1\x28",
        (uint8_t *)"\x7d\xb3\x63\x5b\xf7\xd5\x2f\x66\xdf\x91\xbd\xd7\xdd\x04\x3c\x72\x3f\x05\x71\x79\x08\x63\x48\x4d",
        (uint8_t *)"\xd3\x24\xfd\x7d\xb1\xcf\xaa\x86\x51\x12\x80\xda\xfa\x53\x40\xe6"
    },
    {
        (uint8_t *)"\xf4\xde\x16\x4a\x6c\xa9\x3e\x96\xdf\xc9\x14\x26\xd6\x36\xe4\x81",
        (uint8_t *)"\xcc\x56\x43\xba\x70\x4f\x96\x1c\x9a\x76\xba\x32\xb6\xbe\xa2\x71\xc3\x67\x6a\x05\xfe\x98\x54\x49",
        (uint8_t *)"\x1d\xeb\x55\x3a\xc9\x1e\xc3\x46\x20\x11\x54\xdb\xbd\xac\x9b\x14"
    },
    {
        (uint8_t *)"\x1c\x5b\xab\x7b\x91\x03\x2f\xfa\xc3\xa8\xe4\xd4\x1a\x3a\x53\x38",
        (uint8_t *)"\xce\xed\xa6\x42\x21\xae\x37\xd3\xb0\x1c\x89\xd3\x90\xc5\xc8\xd8\x2f\x9a\xf5\xdc\xa8\xd7\x17\x4a",
        (uint8_t *)"\xad\x98\xde\xf9\xc2\x4e\x9d\x0d\xe0\xe6\xa9\x54\x1c\x86\xc3\x4c"
    },
    {
        (uint8_t *)"\x9c\xac\x4e\xfb\x17\x0d\xc8\xde\xd3\xfc\x6a\x30\x9f\xd7\xac\xa7",
        (uint8_t *)"\x60\x3b\xbb\x7b\xf5\x4b\x36\x5d\x41\xbf\x62\xd1\x35\x74\x66\x60\xa8\x0e\x60\x10\x6a\xe7\xf4\xc1",
        (uint8_t *)"\xe5\x2a\x42\xe7\x80\x48\xc6\xdd\xa6\x3f\x98\xfc\x6c\x5f\x47\xf9"
    },
    {
        (uint8_t *)"\xf7\xd3\xb3\x75\x8e\xcf\x53\x59\xab\x52\x3b\xea\xa1\x7a\x03\x06",
        (uint8_t *)"\x93\x16\x3a\xe2\x8f\x22\x57\x0b\x47\xfc\x0b\x6b\xab\x38\xb5\x6f\xdc\xe4\x22\xb8\xe0\x84\xcf\xba",
        (uint8_t *)"\x6c\x9d\xd0\x76\x75\x0b\xd1\xd2\xc0\xb8\xf2\x03\xca\x14\xee\x1e"
    },
    {
        (uint8_t *)"\x2a\x73\x3f\x40\x7d\x80\x80\x47\x0c\x5f\x22\xa6\xcf\x83\x58\xcd",
        (uint8_t *)"\x14\xfa\x0e\x99\x78\x67\x2a\xd5\xe3\xf3\xa8\x1c\xa5\xaf\xeb\xde\x66\x71\xcc\x9f\xee\x5f\x8f\x9c",
        (uint8_t *)"\x24\xdb\x9f\x77\xf6\x10\x60\xac\xcf\x6d\x41\xe7\x63\x9c\x1e\xc6"
    },
    {
        (uint8_t *)"\xea\x89\xd4\x53\x77\x84\xf2\x53\xea\xe2\xd6\xce\xbd\xd6\x3a\x4c",
        (uint8_t *)"\x21\x09\xb2\x88\x04\x79\xbb\x4f\x68\x12\x1a\xc0\x92\x30\x90\x3f\x5b\x7f\x8e\x63\xd8\x4e\xf8\xdc",
        (uint8_t *)"\x80\x71\x1a\x42\xf6\x68\x7a\x62\x59\x0a\x8a\x0d\x16\x5b\x2f\xb8"
    },
    {
        (uint8_t *)"\xc9\xef\x84\xa2\x68\x87\x7e\xce\xf8\x8b\xb5\x54\xea\x63\xc3\x36",
        (uint8_t *)"\x8f\x13\xf2\xd9\x08\x50\x91\x81\x61\x81\x43\x9a\x8b\xfc\x92\x7b\x35\x62\x19\x0c\x27\xf7\x76\x43",
        (uint8_t *)"\x26\x0d\xd6\xbf\x13\x66\xc0\x29\xb5\xfd\x64\xe7\x28\x53\xd2\xd7"
    },
    {
        (uint8_t *)"\xc5\xac\xdc\x31\x83\x53\xc4\xef\x3f\x6f\x45\xbf\x4a\x84\xc6\x59",
        (uint8_t *)"\xa5\xf1\x9f\x39\x2e\xb2\xaf\xd1\x5c\xf0\xec\x83\xbc\x9b\xea\x0a\xa2\xc2\x9a\x53\xd1\xbd\x24\x7e",
        (uint8_t *)"\xaf\x6a\x60\xf6\x0f\xc0\x85\x65\x6e\x30\x5a\x4c\x05\x0c\xc9\xc3"
    },
    {
        (uint8_t *)"\x2f\x71\x4d\xdb\xd4\xad\xf8\x32\x7d\xc9\x3c\x72\x3a\xeb\xff\xfa",
        (uint8_t *)"\xf2\xf8\xa8\x24\x77\x24\xe2\x89\xce\x95\x86\xe2\x10\x01\x2e\x99\x5b\xd7\x2f\x3b\xb4\xf9\xd7\x9b",
        (uint8_t *)"\x5d\x11\x96\xda\x8f\x18\x49\x75\xe2\x40\x94\x9a\x25\x10\x45\x54"
    }
};

SSFAESUT_t _SSFAES256BlockEncryptMonteUT[] = 
{
    {
        (uint8_t *)"\xb3\x79\x77\x7f\x90\x50\xe2\xa8\x18\xf2\x94\x0c\xbb\xd9\xab\xa4",
        (uint8_t *)"\xf9\xe8\x38\x9f\x5b\x80\x71\x2e\x38\x86\xcc\x1f\xa2\xd2\x8a\x3b\x8c\x9c\xd8\x8a\x2d\x4a\x54\xc6\xaa\x86\xce\x0f\xef\x94\x4b\xe0",
        (uint8_t *)"\x68\x93\xeb\xaf\x0a\x1f\xcc\xc7\x04\x32\x65\x29\xfd\xfb\x60\xdb"
    },
    {
        (uint8_t *)"\x78\xfb\x45\x2f\x38\x4c\x8f\x87\x0e\x57\x28\x90\x58\x8f\x37\x28",
        (uint8_t *)"\x7a\x33\x44\x0a\xd7\xc6\x9d\x58\x33\x55\xc7\x45\xe5\xc8\x8c\x47\x94\x7e\x38\x3a\xb2\x5e\x5f\x99\xba\x3a\x52\xf1\x4b\x96\xc5\x6f",
        (uint8_t *)"\x12\x37\x5e\x02\xa8\xbb\xc8\x4b\x00\xfe\xaa\xb5\x4a\x66\xdb\x43"
    },
    {
        (uint8_t *)"\xd8\xb5\x7d\x7a\x72\xef\x92\x40\x9c\x51\xd4\x0b\xb8\xc4\xcb\xc5",
        (uint8_t *)"\x47\x39\x04\x3d\x77\x50\xbc\xf4\xa6\xf2\x69\xa3\xd5\x40\x83\xca\x95\x30\xa1\x64\xfb\xf0\x47\x40\xef\xf5\xaf\x9a\x39\x7a\x5d\xab",
        (uint8_t *)"\x54\x8c\xc8\x93\xe8\x0c\xaf\x5a\x60\x1c\x23\x81\x51\x7f\x8c\x5b"
    },
    {
        (uint8_t *)"\xf4\xb8\xa6\xed\x6d\x6d\x72\xaf\xf5\x94\x84\x31\x4f\x21\x0b\xb9",
        (uint8_t *)"\x2e\x4e\x21\xa6\xeb\x77\xbb\x39\xa1\xcb\x5c\xd2\x0c\xc5\xfd\x3b\x2e\x96\xb5\xd8\xce\xb6\xfe\xca\x9c\x3f\x31\xfa\x87\x1f\x10\x22",
        (uint8_t *)"\xf5\x6a\x45\x97\xbe\xae\xaf\xc0\xc1\x4e\xe7\x39\x88\xbc\xbe\xe8"
    },
    {
        (uint8_t *)"\xfe\x35\xfe\x16\xa3\x29\x00\x42\xc2\x8c\x02\x1e\xe9\xed\xe7\x3f",
        (uint8_t *)"\x93\xc5\xc8\x40\x34\x10\x76\x47\x17\xe5\x47\xe3\xd0\x7b\x0e\xc3\x44\xcc\x9e\xc1\x2f\xb1\x13\x0d\x49\x9b\xba\x47\xa4\x31\x00\x0b",
        (uint8_t *)"\x01\x41\x87\x1c\x35\x7a\x00\xad\x37\xae\x65\x59\x78\x30\xca\xc8"
    },
    {
        (uint8_t *)"\x1b\xbf\x65\x1c\xf6\x1c\x29\x5c\x96\xe7\x3a\x21\x04\x83\xd7\xa1",
        (uint8_t *)"\xd0\x4d\x80\x99\x8a\x97\x1e\xc5\x2d\x53\x90\xfa\x7e\xaf\x78\xea\xc8\x3e\xa3\xd3\xd1\x36\x0c\xb0\x7c\x0e\x87\x81\x0b\x01\xcf\x90",
        (uint8_t *)"\x84\xb4\x2f\x75\xc3\xb6\x2b\xbf\x21\x70\x7b\xa6\x6c\xca\x39\x9f"
    },
    {
        (uint8_t *)"\xa7\x5b\x28\xbe\x92\xdc\x53\xde\x9d\x44\x71\x49\x18\xe3\xc5\x41",
        (uint8_t *)"\x14\xba\x26\xba\xfb\x6c\x84\x10\x10\x4d\x70\xec\x23\x87\x6d\xb5\x68\x84\x32\x6f\x16\xde\xab\xc6\xdc\x1b\x6a\xe7\xe3\xe7\xa4\x4e",
        (uint8_t *)"\x48\x69\x30\x25\xba\x68\xf3\xfa\x35\x15\xe7\x11\x2b\x6e\x32\xaa"
    },
    {
        (uint8_t *)"\x5c\x4d\x21\xe6\x04\x5f\x11\xf9\xf9\x1a\x8c\xef\x13\x03\x04\xe0",
        (uint8_t *)"\x6a\x25\x7a\x4f\x65\xbd\xd7\xd8\x82\xff\x45\xff\xbb\x95\x41\xe5\x72\x3d\xf2\x99\x9f\x15\xeb\x91\x0e\xb7\xd4\x72\x86\x8e\x52\xbf",
        (uint8_t *)"\x4f\x50\x67\x9c\x2d\xbf\xa6\x3b\x5e\x55\xd0\x31\xaf\xac\xd4\x4b"
    },
    {
        (uint8_t *)"\xf2\x1d\xf1\xe9\x9a\x78\x1d\xba\x4a\x68\xff\x34\x91\x84\x8f\x99",
        (uint8_t *)"\x88\xc8\x8e\xc4\xd6\x3e\xb4\x81\xcd\x8d\x6e\x8e\x8d\x2e\x27\x15\xdc\xab\x18\x9b\x04\x77\x1e\x66\xd1\xc9\x24\x25\x87\xd7\x9a\xd8",
        (uint8_t *)"\xe4\xe8\xc9\xe4\x96\x3a\x44\xf5\xcf\x27\x76\x7e\x4e\x42\xfa\x61"
    },
    {
        (uint8_t *)"\x86\xa8\x33\x2f\x16\xf9\x97\xbc\x02\xaf\x52\x71\xc6\x4e\x7e\x0f",
        (uint8_t *)"\x67\x2e\x7b\x0d\x49\x74\x58\xe2\x60\x08\x46\x62\xc5\x66\x39\x4e\x0f\x88\xf4\x0e\x71\xc9\x3b\x39\x75\x29\xe1\x0c\x5d\x26\x20\x3c",
        (uint8_t *)"\x8e\x53\x85\x8c\xe7\xad\x0d\x25\x41\x0f\x88\x6e\xee\xca\x1e\x0e"
    },
    {
        (uint8_t *)"\x80\x5b\xe6\x27\x89\x54\x9c\xe6\xaf\x74\x96\x64\x67\xf4\x11\x35",
        (uint8_t *)"\x6d\x7f\x0f\x75\x84\x16\x2a\x1f\xa4\xdd\x67\x64\x54\x8f\x35\x5a\xf2\x2f\x77\x54\x29\xbb\xc7\x76\x84\x8a\x58\x6a\x75\xce\x6f\x76",
        (uint8_t *)"\xab\x60\x01\xc6\xc4\xc5\x6e\x8c\xa3\x93\xc5\xfd\x17\x35\x05\xba"
    },
    {
        (uint8_t *)"\x5c\x8e\x62\x2d\xdb\xd3\x2e\xe7\x9c\x17\x57\x2e\x8b\x3e\xe6\x1c",
        (uint8_t *)"\x31\x2c\x5b\x43\x26\x3c\x1a\xf8\xd1\xe3\x5c\x0f\x24\xd1\x00\x43\x86\xee\x1c\xc0\x10\x0f\xb3\xad\xfb\x71\x07\xe3\xf4\xea\xff\x5e",
        (uint8_t *)"\xc5\xd2\xcb\x3d\x5b\x7f\xf0\xe2\x3e\x30\x89\x67\xee\x07\x48\x25"
    }
};

SSFAESUT_t _SSFAES128BlockDecryptMonteUT[] = 
{
    {
        (uint8_t *)"\xb0\x8a\x29\xb1\x1a\x50\x0e\xa3\xac\xa4\x2c\x36\x67\x5b\x97\x85",
        (uint8_t *)"\x0c\x60\xe7\xbf\x20\xad\xa9\xba\xa9\xe1\xdd\xf0\xd1\x54\x07\x26",
        (uint8_t *)"\xb6\x13\xb8\x70\x85\xfe\xd1\xbb\x87\xf0\x7a\x57\x4e\x6d\x28\x79"
    },
    {
        (uint8_t *)"\x12\x4b\x19\xb2\x50\x1a\x54\x00\x66\xdd\xf7\x94\x34\x17\xcb\xa3",
        (uint8_t *)"\x02\xc2\xf6\x8c\xc8\x11\xc1\x79\x4b\xcc\x25\x9f\xcd\x61\x76\xfb",
        (uint8_t *)"\x23\xe7\xc9\x5f\x7e\xd9\x01\x7a\xf3\x39\xc2\x34\xb7\xa8\xfc\xc4"
    },
    {
        (uint8_t *)"\xf3\xf1\xf9\x64\xb9\x8b\x34\x98\x89\x8c\x30\x32\xe4\x4a\x30\x8c",
        (uint8_t *)"\xda\x19\x0d\xeb\xcf\x16\x9b\xd6\xef\x02\x38\x09\x07\x15\x3b\x57",
        (uint8_t *)"\x40\xcc\xc3\xa2\x61\x41\x90\x02\x80\xa3\xa7\xb6\x2d\x4e\xd8\xb6"
    },
    {
        (uint8_t *)"\x56\x1d\x95\x84\x78\x69\xcc\xcc\x81\xdf\x7d\xf6\x5d\x70\x80\x8d",
        (uint8_t *)"\x7e\x35\x1a\xbe\xd9\x0d\xdc\xb4\x15\x4d\x46\xfc\xa4\x7b\x29\xd6",
        (uint8_t *)"\x17\xb9\xe6\xf8\x6e\xc1\xcf\xf2\x2c\xc6\xf8\xe1\x40\x72\xbb\x0f"
    },
    {
        (uint8_t *)"\x67\x31\x9b\x7a\xb3\x94\x93\x72\x44\xb9\x39\x77\xba\x06\xc1\xee",
        (uint8_t *)"\xd3\x6d\xba\xed\xce\xad\xfa\x32\xf4\x6e\x64\xf2\x81\x50\x8d\xf6",
        (uint8_t *)"\xd9\x56\xa3\x11\x88\xa6\x67\xee\xa4\x4c\x93\x58\x2d\x6a\xed\x6f"
    },
    {
        (uint8_t *)"\x11\xbc\x0b\xe2\x04\x65\x84\x89\x34\xc0\xfd\x7d\x7c\xed\x8b\xd1",
        (uint8_t *)"\x75\xb1\x6f\x8c\x59\xc0\xee\x9a\xfc\x15\x90\x8f\xa3\x9a\x2c\xaf",
        (uint8_t *)"\x69\xd4\x8f\x1c\xa3\x99\x77\xf1\xc0\x5f\x8c\xab\xd5\xf7\xe4\xac"
    },
    {
        (uint8_t *)"\x4e\x5d\x32\xa0\xe4\x0d\xd9\xb8\x30\xaf\x0c\x29\x04\x51\x89\x06",
        (uint8_t *)"\x0c\x94\x54\xf5\xdb\xec\xb0\x4d\x0d\x2a\x6c\x96\xc1\x4d\x4a\xb4",
        (uint8_t *)"\x40\xa7\xff\x6a\x6d\x0e\xa1\x35\x24\x5d\x5b\x24\xa0\x00\x44\x66"
    },
    {
        (uint8_t *)"\x96\xab\x8b\xd9\x09\x1a\x70\x3a\x6e\x6d\x1a\x21\x90\xf0\xb5\xc9",
        (uint8_t *)"\x93\x51\xb5\xd1\x97\x27\x40\x29\x97\x43\xfa\xaf\x27\xc1\xd3\x56",
        (uint8_t *)"\x84\x18\xc2\xce\xc9\xd7\xcc\x38\x25\x15\x27\x90\xf1\x20\x48\x8f"
    },
    {
        (uint8_t *)"\xf6\x47\x2d\x8a\x7d\x28\x8d\xb2\x26\x2d\x82\x6f\xf2\xf8\x06\xee",
        (uint8_t *)"\x7a\x87\x06\xda\x2e\xfa\xeb\xab\x38\x63\xc8\xc0\xd7\x68\xed\xe0",
        (uint8_t *)"\xd3\xec\x20\xae\x32\x57\x19\x2d\x51\xf2\xce\x4e\x73\xf8\x7e\x53"
    },
    {
        (uint8_t *)"\xd9\x96\x30\xcb\x34\xf0\x6a\x3a\x02\xe9\x80\x3a\x02\x99\x80\xa2",
        (uint8_t *)"\x3c\xce\xb1\x92\x0e\x69\xa0\xda\x16\xc1\xc8\xa8\x53\x44\xa3\x84",
        (uint8_t *)"\xe5\xa1\x4b\x33\x44\x30\x76\x8e\xdf\x5d\xd7\x86\x3e\xe3\x06\x78"
    },
    {
        (uint8_t *)"\xc7\xc6\x22\xfe\xe0\x0a\x18\x0f\x31\x31\xa5\x7a\x82\xac\xf7\xa9",
        (uint8_t *)"\x93\xa3\xcb\x21\xb9\x65\x2b\xa4\xdb\x61\xbc\x39\x43\x33\x4c\x73",
        (uint8_t *)"\xe0\x96\xb0\x40\x6e\x6e\x8a\xbb\x6c\xed\x35\x3f\x1b\xe4\x06\x93"
    },
    {
        (uint8_t *)"\x1a\x23\xd3\x71\xb9\x7e\x10\x56\xe8\xbc\x95\x45\xc5\x6c\xab\x9e",
        (uint8_t *)"\xad\x98\x9a\xd0\x43\x81\xd9\xb2\xec\x8d\x05\xf8\xaa\x93\x27\xec",
        (uint8_t *)"\xd1\xd2\xbf\xdc\x58\xff\xca\xd2\x34\x1b\x09\x5b\xce\x55\x22\x1e"
    }
};

SSFAESUT_t _SSFAES192BlockDecryptMonteUT[] = 
{
    {
        (uint8_t *)"\xd0\xbd\x0e\x02\xde\xd1\x55\xe4\x51\x6b\xe8\x3f\x42\xd3\x47\xa4",
        (uint8_t *)"\x4b\x97\x58\x57\x01\xc0\x3f\xbe\xbd\xfa\x85\x55\x02\x4f\x58\x9f\x14\x82\xc5\x8a\x00\xfd\xd9\xfd",
        (uint8_t *)"\xc7\xb6\x58\x1c\xcc\x88\xf7\xfc\x26\xd1\x5d\x27\x31\xe7\x25\x1b"
    },
    {
        (uint8_t *)"\xd1\x64\x63\x74\x5d\xa3\x8e\xf8\x99\x7e\x20\xe1\x02\xfb\x85\x73",
        (uint8_t *)"\x18\x7b\xc7\x71\xe5\x67\xfb\x12\x85\xee\x18\xde\x77\xcb\x0a\x7b\xd0\xc1\xe1\x8b\x00\xdf\x1d\x05",
        (uint8_t *)"\x98\xea\x16\x87\x5a\x9e\x30\x06\xde\x15\x0e\x93\xbe\x95\x85\xb8"
    },
    {
        (uint8_t *)"\x1e\x69\x30\x09\xbe\x7a\x86\x8d\xb9\xe6\xa4\x95\xc2\xe2\x38\xf3",
        (uint8_t *)"\x7a\x64\x6e\xa7\xab\x6a\x11\x10\x1a\x35\x06\xda\xc6\x4c\x05\xbd\xa9\xd7\xb0\xf0\x79\xe1\x12\x85",
        (uint8_t *)"\x49\xf5\x52\x37\xf9\xa6\x60\x50\xb7\xe0\x4e\x66\xa0\xb4\xbf\x24"
    },
    {
        (uint8_t *)"\x49\x27\xab\x19\x55\x21\x02\x41\x4e\x39\x12\x6b\x8a\x91\xc6\x75",
        (uint8_t *)"\xc9\x97\x88\xfd\x8d\xc7\xa7\x24\x6c\x38\x2e\xc2\x26\x05\xac\xc0\xbb\xdd\xfe\xb7\x26\xa5\x49\x97",
        (uint8_t *)"\x99\xea\x6c\xcf\x10\x0d\x06\x24\x3b\x45\x99\x8d\x68\xc9\xb6\xbc"
    },
    {
        (uint8_t *)"\xbe\x46\xea\xd5\xf4\x31\xee\x2c\x6d\x17\x95\xf8\x52\x55\x8e\xd7",
        (uint8_t *)"\x94\xaf\xb2\xde\x65\x6d\xaf\x68\x8b\xdd\x3b\xc0\xc1\x49\xcd\x5f\x8e\x87\x9d\x58\x0b\x95\xfc\xbf",
        (uint8_t *)"\x9f\x1e\xcd\x98\x39\xab\xd6\xab\xbe\xcb\xa8\x9a\x71\x40\x5c\x76"
    },
    {
        (uint8_t *)"\x72\x36\x0b\x4f\xcd\x12\x93\xa3\x6e\xd0\xbb\x44\x21\x3d\xa8\xb9",
        (uint8_t *)"\x50\x25\x73\x06\xe7\x57\xd7\x65\x67\xef\x10\xb9\x10\x48\xb6\x75\xac\xdd\x27\x28\x81\x66\xcd\x7e",
        (uint8_t *)"\x98\x21\x19\x60\x0a\x3e\x73\xdf\xf3\x35\x83\x55\x81\x34\xbc\xf0"
    },
    {
        (uint8_t *)"\x79\x35\x54\xc1\xcc\x56\x5f\x00\xf9\xf2\x12\x2b\xd0\x66\x72\xaa",
        (uint8_t *)"\xf2\x53\x72\x34\x71\x59\x0c\x24\x9c\x12\xa5\xde\x65\x9d\x9f\x28\xc6\xc9\xc6\x17\x7e\x2b\x3b\x75",
        (uint8_t *)"\xb8\x9f\xee\xe1\x7d\x71\xa4\x52\xb4\x6e\x46\x83\xcf\xdd\xc0\xba"
    },
    {
        (uint8_t *)"\x28\x43\xb7\xb7\x10\x7b\x13\x90\xbe\x39\x31\x37\xe3\xe2\x66\xc9",
        (uint8_t *)"\x87\x06\xa8\xa8\xfa\xb0\x2e\x3d\xd2\x23\x67\x89\xde\xf9\x3e\xa3\x2f\x83\xe9\xcf\x5b\x85\x3d\x6d",
        (uint8_t *)"\xd5\xfa\xe7\x3a\x89\x40\xec\x3c\x1b\xeb\xe8\xa5\xe4\xfa\x04\x23"
    },
    {
        (uint8_t *)"\xd6\x59\x7f\xe3\x68\x7c\x9d\xc2\xf6\x08\x7a\xd4\x8b\xb2\xab\x18",
        (uint8_t *)"\x94\x67\xdf\x27\xc2\xb9\x0c\xa7\x41\x6e\x05\xf0\xee\xbc\x46\xe0\x3e\xc6\xd6\x52\x3a\x29\x60\x39",
        (uint8_t *)"\xfd\x6a\xbd\xb2\x79\x3f\x84\x9b\xed\xea\x16\x0e\x34\xab\x1a\x9d"
    },
    {
        (uint8_t *)"\xd7\x3e\x44\xee\x7f\x75\xc2\xfb\x66\x96\xaa\xba\x64\xaf\x99\x25",
        (uint8_t *)"\xa8\x01\x25\x60\x6e\xf3\xf3\x95\x3f\x60\xb3\xe5\xe6\x47\x93\xe6\xd7\x22\x96\x10\x85\x6e\xd8\x9d",
        (uint8_t *)"\x1a\xdd\x98\xac\xb3\xa3\x17\x33\xb3\xe0\xa3\x2d\xa1\x4a\x71\xcf"
    },
    {
        (uint8_t *)"\x89\xeb\xc0\x90\xe0\x7d\x36\x67\x0f\x48\xa3\x20\x74\xc9\xca\x18",
        (uint8_t *)"\xb7\xc5\x64\x16\x1c\x5e\x50\x61\xb0\xfc\xcf\x82\x55\xee\xfe\x51\x95\xef\xf7\x86\xde\x19\x7e\xbb",
        (uint8_t *)"\x56\x95\x15\x4c\x14\xae\xb5\xd0\x9a\x51\x6c\xa8\x02\xd7\xfb\x21"
    },
    {
        (uint8_t *)"\x91\x34\x1b\x21\x7d\x52\x11\x68\x25\x1a\xd3\x77\x81\x71\xe5\xba",
        (uint8_t *)"\x0a\xbe\xa3\x78\x84\x94\x6a\xa1\xe4\x82\xa4\x45\x85\x77\x70\xf8\x2b\x10\xde\xab\xa0\x43\x11\x02",
        (uint8_t *)"\xb6\x3e\xf1\xb7\x95\x07\xa6\x2e\xba\x3d\xaf\xce\xc5\x4a\x63\x28"
    }
};

SSFAESUT_t _SSFAES256BlockDecryptMonteUT[] = 
{
    {
        (uint8_t *)"\x89\x64\x9b\xd0\x11\x5f\x30\xbd\x87\x85\x67\x61\x02\x23\xa5\x9d",
        (uint8_t *)"\x2b\x09\xba\x39\xb8\x34\x06\x2b\x9e\x93\xf4\x83\x73\xb8\xdd\x01\x8d\xed\xf1\xe5\xba\x1b\x8a\xf8\x31\xeb\xba\xcb\xc9\x2a\x26\x43",
        (uint8_t *)"\x1f\x9b\x9b\x21\x3f\x18\x84\xfa\x98\xb6\x2d\xd6\x63\x9f\xd3\x3b"
    },
    {
        (uint8_t *)"\xf6\x17\xd2\x6b\x55\xda\x99\x9d\x65\xb2\xd2\x36\x35\x8b\x2e\x60",
        (uint8_t *)"\x12\x67\x52\xda\x3d\x7f\x9a\x0f\xfc\x1a\x46\xcc\xaa\x8a\x39\x25\xd1\xf4\xc6\x9f\x9b\xc4\x67\x29\x03\x2d\xd5\x4e\x6c\x83\x4d\x5f",
        (uint8_t *)"\x06\x6f\xfe\xa7\x99\xad\x5f\x09\xd0\x3c\xb8\x68\xde\xb1\x59\x1e"
    },
    {
        (uint8_t *)"\xce\xed\x1c\x8b\x96\xd8\x49\x51\xca\xdf\x80\x9d\x3e\xa1\xb3\x97",
        (uint8_t *)"\xf1\x38\xad\x91\x22\x01\xbe\xec\xd1\x5e\xbe\x20\x49\xf9\x80\xe5\x88\xda\x3c\x01\x0a\x35\xb7\xce\x20\x49\x2f\x56\xa9\x8d\x70\xa3",
        (uint8_t *)"\xf8\x8a\xed\x84\xbc\xa4\x2a\x06\x64\x7d\x65\x04\xa5\xc4\x83\x79"
    },
    {
        (uint8_t *)"\x5a\x9a\xd2\x4f\xe4\x56\xf4\xf7\x66\xe8\x39\xa8\x10\x13\x73\xc3",
        (uint8_t *)"\xb2\x25\x71\xc6\x2e\xe4\xe0\xb4\xeb\xd7\xd7\x76\x70\x3c\x13\x45\xaf\xc5\x5a\xd9\x2e\xbf\x7a\xf2\x71\x10\x0b\x58\x40\xf1\x0a\x7f",
        (uint8_t *)"\xa3\x0e\x9a\x77\x30\x62\x8b\x56\x0c\x71\x96\x7b\xdb\x35\xef\xce"
    },
    {
        (uint8_t *)"\xac\x67\x50\x8a\x8b\xca\xb6\x9f\x96\xea\xd2\x91\x21\x71\x8c\xd7",
        (uint8_t *)"\x9a\xa1\xff\xa9\xe1\x75\xf0\x3a\x6b\xcc\x71\xfc\x2a\xea\x3a\x52\x2c\x8b\xa6\xc1\xf8\x47\x95\x4e\x03\x62\xe9\xca\x0b\xb8\x42\x2c",
        (uint8_t *)"\x49\xd2\xca\xc2\xca\x39\xa3\xb6\x63\x02\xe5\xf3\x65\x0e\x71\xd7"
    },
    {
        (uint8_t *)"\x6f\x4e\x5c\x40\xe4\x13\x5a\xbf\xdf\x29\x4b\x4d\x8c\x93\x04\xb3",
        (uint8_t *)"\x2a\x6c\x92\x8b\xf8\xc2\xb3\x2c\xe8\x2e\xd0\xbe\x1b\xc9\x54\xb9\x6d\x62\xc8\xe6\x63\x91\x5d\x0e\x57\xca\x09\xc6\x94\x53\x53\x5b",
        (uint8_t *)"\xca\xc0\x32\xdd\xc2\xb2\x74\x43\xd7\x0d\x0f\x2d\xfb\x1a\x1d\x87"
    },
    {
        (uint8_t *)"\x1f\xdc\x5f\xee\x9e\xb6\x40\xff\x54\x7a\x98\xd9\xe1\x60\x1b\x52",
        (uint8_t *)"\x39\xf1\x84\x05\xf0\xb1\xda\x64\x7f\x99\x47\x9e\x87\xd4\xd1\x53\x13\x2d\x3d\x34\xc9\xba\x60\xf0\x86\xb4\x55\x02\xf5\xad\x29\x24",
        (uint8_t *)"\x93\x66\x09\x87\x6c\xd6\xee\xbf\x31\xdb\x5a\x6a\xf7\x83\x98\x44"
    },
    {
        (uint8_t *)"\xe9\xc9\x16\xa2\x1d\xec\x96\x62\xbd\xd9\x1a\x0f\x86\x5f\x8b\x47",
        (uint8_t *)"\xba\x5c\x2b\xd4\x13\xda\xca\x78\x66\xde\x11\xc1\x1d\xb2\x92\x66\x94\xf4\x67\x52\x06\x05\xcf\x8f\xb2\x2c\xca\x80\x1d\xcf\xba\x83",
        (uint8_t *)"\x92\xb3\xab\x3e\x28\xf6\xc6\x06\x50\x87\x06\xe0\xc3\xd7\x6d\x28"
    },
    {
        (uint8_t *)"\x38\xbf\xea\x7e\x1e\xec\xe7\x41\xeb\x6a\x96\x01\x60\x51\x29\xdd",
        (uint8_t *)"\x1f\xbc\xf4\xff\xb3\x6f\x76\xb8\x83\x23\xf7\x45\xb3\x15\x29\x47\xe8\x51\x2c\x8e\x96\xef\xd7\xd4\x90\x45\xb2\x90\x10\x70\xb0\xbe",
        (uint8_t *)"\x71\xcd\x66\xb3\xb3\x55\x3b\x6a\xa6\x32\xc3\x38\xa3\x07\xe1\x1a"
    },
    {
        (uint8_t *)"\xef\x6a\xbb\x8a\xe0\x07\xb7\x30\xbe\x45\xaa\x85\xe3\x9f\x36\x2d",
        (uint8_t *)"\xdb\x89\x7d\x48\xa3\x17\xf6\x64\x12\xa8\xc5\x21\x11\xc3\xf3\xb0\x6e\x64\x48\x93\xba\x8b\xe3\xfc\x05\x03\xaf\xbc\x68\x05\xef\x00",
        (uint8_t *)"\xe5\xbd\x2e\xdf\xb7\xe5\x63\xf6\xcd\x86\xda\x75\x7c\x4c\x37\x0f"
    },
    {
        (uint8_t *)"\x15\x15\xef\x6a\x25\xcf\x39\x43\xea\xda\xdc\x36\xa0\x29\x19\x4a",
        (uint8_t *)"\xc4\xbd\xe4\xa0\xc5\xf8\x03\x29\xbe\x6d\xd5\x15\xf5\xbf\x6d\xab\xd8\x05\xdd\x0a\x9e\xd8\x53\xa9\x4b\xa0\x20\x87\xba\xe9\x59\x6e",
        (uint8_t *)"\x7b\x4a\xd9\x46\xdf\xb5\x9c\x80\xb1\xdc\x5c\xed\xb2\xfa\x87\xa0"
    },
    {
        (uint8_t *)"\xc8\x3e\x20\xe1\x8f\x2b\x14\x57\x78\x89\x54\xb4\x9f\xd8\x43\x07",
        (uint8_t *)"\x99\x77\xc9\x85\x74\x5b\xc3\x39\x54\xa2\xce\x89\x8b\xc8\xfe\xbd\xaa\x2c\xf3\xbb\x42\x10\xe6\xa7\x2a\xd1\xec\x65\xa4\xe5\x48\x89",
        (uint8_t *)"\xe3\xd3\x86\x8f\x57\x8c\xaf\x34\xe3\x64\x45\xbf\x14\xce\xfc\x68"
    }
};

/* --------------------------------------------------------------------------------------------- */
/* Unit tests the AES external interface.                                                        */
/* --------------------------------------------------------------------------------------------- */
void SSFAESUnitTest(void)
{
    uint32_t i, j, k;
    uint8_t out[32];
    uint8_t key[32];
    uint8_t in[16];

    SSF_ASSERT_TEST(SSFAES128BlockEncrypt(NULL, 16, out, 16, _SSFAES128BlockEncryptMonteUT[0].key,
                                          16));
    SSF_ASSERT_TEST(SSFAES128BlockEncrypt(_SSFAES128BlockEncryptMonteUT[0].in, 16, NULL, 16,
                                     _SSFAES128BlockEncryptMonteUT[0].key, 16));
    SSF_ASSERT_TEST(SSFAES128BlockEncrypt(_SSFAES128BlockEncryptMonteUT[0].in, 16, out, 16, NULL,
                                          16));

    SSF_ASSERT_TEST(SSFAES128BlockDecrypt(NULL, 16, out, 16, _SSFAES128BlockDecryptMonteUT[0].key,
                                          16));
    SSF_ASSERT_TEST(SSFAES128BlockDecrypt(_SSFAES128BlockDecryptMonteUT[0].in, 16, NULL, 16,
                                     _SSFAES128BlockDecryptMonteUT[0].key, 16));
    SSF_ASSERT_TEST(SSFAES128BlockDecrypt(_SSFAES128BlockDecryptMonteUT[0].in, 16, out, 16, NULL,
                                          16));

    SSF_ASSERT_TEST(SSFAES192BlockEncrypt(NULL, 16, out, 16, _SSFAES192BlockEncryptMonteUT[0].key,
                                          24));
    SSF_ASSERT_TEST(SSFAES192BlockEncrypt(_SSFAES192BlockEncryptMonteUT[0].in, 16, NULL, 16,
                                     _SSFAES192BlockEncryptMonteUT[0].key, 24));
    SSF_ASSERT_TEST(SSFAES192BlockEncrypt(_SSFAES192BlockEncryptMonteUT[0].in, 16, out, 16, NULL,
                                          24));

    SSF_ASSERT_TEST(SSFAES192BlockDecrypt(NULL, 16, out, 16, _SSFAES192BlockDecryptMonteUT[0].key,
                                          24));
    SSF_ASSERT_TEST(SSFAES192BlockDecrypt(_SSFAES192BlockDecryptMonteUT[0].in, 16, NULL, 16,
                                     _SSFAES192BlockDecryptMonteUT[0].key, 24));
    SSF_ASSERT_TEST(SSFAES192BlockDecrypt(_SSFAES192BlockDecryptMonteUT[0].in, 16, out, 16, NULL,
                                          24));

    SSF_ASSERT_TEST(SSFAES256BlockEncrypt(NULL, 16, out, 16, _SSFAES256BlockEncryptMonteUT[0].key,
                                         32));
    SSF_ASSERT_TEST(SSFAES256BlockEncrypt(_SSFAES256BlockEncryptMonteUT[0].in, 16, NULL, 16,
                                     _SSFAES256BlockEncryptMonteUT[0].key, 32));
    SSF_ASSERT_TEST(SSFAES256BlockEncrypt(_SSFAES256BlockEncryptMonteUT[0].in, 16, out, 16, NULL,
                                          32));

    SSF_ASSERT_TEST(SSFAES256BlockDecrypt(NULL, 16, out, 16, _SSFAES256BlockDecryptMonteUT[0].key,
                                          32));
    SSF_ASSERT_TEST(SSFAES256BlockDecrypt(_SSFAES256BlockDecryptMonteUT[0].in, 16, NULL, 16,
                                     _SSFAES256BlockDecryptMonteUT[0].key, 32));
    SSF_ASSERT_TEST(SSFAES256BlockDecrypt(_SSFAES256BlockDecryptMonteUT[0].in, 16, out, 16, NULL, 
                                          32));

    memcpy(in, _SSFAES128BlockEncryptMonteUT[0].in, 16);
    memcpy(key, _SSFAES128BlockEncryptMonteUT[0].key, 16);

    for (i = 0; i < (sizeof(_SSFAES128BlockEncryptMonteUT) / sizeof(SSFAESUT_t)); i++)
    {
        for (j = 0; j < 9; j++)
        {
            if (j == 0)
            {
                SSF_ASSERT(memcmp(in, _SSFAES128BlockEncryptMonteUT[i].in, 16) == 0);
                SSF_ASSERT(memcmp(key, _SSFAES128BlockEncryptMonteUT[i].key, 16) == 0);
            }

            for (k = 0; k < 1000; k++)
            {
                SSFAES128BlockEncrypt(in, 16, out, 16, key, 16);
                memcpy(in, out, 16);
            }

            if (j == 0)
            {
                SSF_ASSERT(memcmp(in, _SSFAES128BlockEncryptMonteUT[i].out, 16) == 0);
            }

            for (k = 0; k < 16; k++)
            {
                key[k] ^= in[k];
            }
        }
    }

    memcpy(in, _SSFAES128BlockDecryptMonteUT[0].in, 16);
    memcpy(key, _SSFAES128BlockDecryptMonteUT[0].key, 16);
    
    for (i = 0; i < (sizeof(_SSFAES128BlockDecryptMonteUT) / sizeof(SSFAESUT_t)); i++)
    {
        for (j = 0; j < 9; j++)
        {
            if (j == 0)
            {
                SSF_ASSERT(memcmp(in, _SSFAES128BlockDecryptMonteUT[i].in, 16) == 0);
                SSF_ASSERT(memcmp(key, _SSFAES128BlockDecryptMonteUT[i].key, 16) == 0);
            }

            for (k = 0; k < 1000; k++)
            {
                SSFAES128BlockDecrypt(in, 16, out, 16, key, 16);
                memcpy(in, out, 16);
            }

            if (j == 0)
            {
                SSF_ASSERT(memcmp(in, _SSFAES128BlockDecryptMonteUT[i].out, 16) == 0);
            }

            for (k = 0; k < 16; k++)
            {
                key[k] ^= in[k];
            }
        }
    }

    memcpy(in, _SSFAES192BlockEncryptMonteUT[0].in, 16);
    memcpy(key, _SSFAES192BlockEncryptMonteUT[0].key, 24);
    
    for (i = 0; i < (sizeof(_SSFAES192BlockEncryptMonteUT) / sizeof(SSFAESUT_t)); i++)
    {
        for (j = 0; j < 9; j++)
        {
            if (j == 0)
            {
                SSF_ASSERT(memcmp(in, _SSFAES192BlockEncryptMonteUT[i].in, 16) == 0);
                SSF_ASSERT(memcmp(key, _SSFAES192BlockEncryptMonteUT[i].key, 24) == 0);
            }

            for (k = 0; k < 1000; k++)
            {
                memcpy(&out[16], out, 16);
                SSFAES192BlockEncrypt(in, 16, out, 16, key, 24);
                memcpy(in, out, 16);
            }

            if (j == 0)
            {
                SSF_ASSERT(memcmp(in, _SSFAES192BlockEncryptMonteUT[i].out, 16) == 0);
            }

            for (k = 0; k < 8; k++)
            {
                key[7 - k] ^= out[31 - k];
            }

            for (k = 8; k < 24; k++)
            {
                key[k] ^= in[k - 8];
            }
        }
    }

    memcpy(in, _SSFAES192BlockDecryptMonteUT[0].in, 16);
    memcpy(key, _SSFAES192BlockDecryptMonteUT[0].key, 24);
    
    for (i = 0; i < (sizeof(_SSFAES192BlockDecryptMonteUT) / sizeof(SSFAESUT_t)); i++)
    {
        for (j = 0; j < 9; j++) 
        {
            if (j == 0)
            {
                SSF_ASSERT(memcmp(in, _SSFAES192BlockDecryptMonteUT[i].in, 16) == 0);
                SSF_ASSERT(memcmp(key, _SSFAES192BlockDecryptMonteUT[i].key, 24) == 0);
            }

            for (k = 0; k < 1000; k++)
            {
                memcpy(&out[16], out, 16);
                SSFAES192BlockDecrypt(in, 16, out, 16, key, 24);
                memcpy(in, out, 16);
            }

            if (j == 0)
            {
                SSF_ASSERT(memcmp(in, _SSFAES192BlockDecryptMonteUT[i].out, 16) == 0);
            }

            for (k = 0; k < 8; k++)
            {
                key[7 - k] ^= out[31 - k];
            }

            for (k = 8; k < 24; k++)
            {
                key[k] ^= in[k - 8];
            }
        }
    }

    memcpy(in, _SSFAES256BlockEncryptMonteUT[0].in, 16);
    memcpy(key, _SSFAES256BlockEncryptMonteUT[0].key, 32);
    
    for (i = 0; i < (sizeof(_SSFAES256BlockEncryptMonteUT) / sizeof(SSFAESUT_t)); i++)
    {
        for (j = 0; j < 9; j++)
        {
            if (j == 0)
            {
                SSF_ASSERT(memcmp(in, _SSFAES256BlockEncryptMonteUT[i].in, 16) == 0);
                SSF_ASSERT(memcmp(key, _SSFAES256BlockEncryptMonteUT[i].key, 32) == 0);
            }

            for (k = 0; k < 1000; k++)
            {
                memcpy(&out[16], out, 16);
                SSFAES256BlockEncrypt(in, 16, out, 16, key, 32);
                memcpy(in, out, 16);
            }

            if (j == 0)
            {
                SSF_ASSERT(memcmp(in, _SSFAES256BlockEncryptMonteUT[i].out, 16) == 0);
            }

            for (k = 0; k < 16; k++)
            {
                key[15 - k] ^= out[31 - k];
            }

            for (k = 16; k < 32; k++)
            {
                key[k] ^= in[k - 16];
            }
        }
    }

    memcpy(in, _SSFAES256BlockDecryptMonteUT[0].in, 16);
    memcpy(key, _SSFAES256BlockDecryptMonteUT[0].key, 32);

    for (i = 0; i < (sizeof(_SSFAES256BlockDecryptMonteUT) / sizeof(SSFAESUT_t)); i++)
    {
        for (j = 0; j < 9; j++)
        {
            if (j == 0)
            {
                SSF_ASSERT(memcmp(in, _SSFAES256BlockDecryptMonteUT[i].in, 16) == 0);
                SSF_ASSERT(memcmp(key, _SSFAES256BlockDecryptMonteUT[i].key, 32) == 0);
            }

            for (k = 0; k < 1000; k++)
            {
                memcpy(&out[16], out, 16);
                SSFAES256BlockDecrypt(in, 16, out, 16, key, 32);
                memcpy(in, out, 16);
            }

            if (j == 0)
            {
                SSF_ASSERT(memcmp(in, _SSFAES256BlockDecryptMonteUT[i].out, 16) == 0);
            }

            for (k = 0; k < 16; k++)
            {
                key[15 - k] ^= out[31 - k];
            }

            for (k = 16; k < 32; k++)
            {
                key[k] ^= in[k - 16];
            }
        }
    }
}
#endif /* SSF_CONFIG_AES_UNIT_TEST */

